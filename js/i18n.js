// ===== MULTI-LANGUAGE SUPPORT =====

const translations = {
    'en': {
        // Navigation
        'nav.home': 'Home',
        'nav.features': 'Features',
        'nav.about': 'About',
        'nav.contact': 'Contact',
        
        // Hero Section
        'hero.title': 'MemoSpace',
        'hero.subtitle': 'Reimagined for Vision OS',
        'hero.description': 'Experience spatial computing like never before. Organize your memories, thoughts, and ideas in a three-dimensional workspace that adapts to your mind.',
        'hero.cta.primary': 'Try the Experience',
        'hero.cta.secondary': 'Watch Demo',
        
        // Features Section
        'features.title': 'Revolutionary Features',
        'features.subtitle': 'Designed for the future of spatial computing',
        'features.spatial.title': 'Spatial Organization',
        'features.spatial.description': 'Organize your memories in three-dimensional space with intuitive gestures and eye tracking.',
        'features.ai.title': 'AI-Powered Insights',
        'features.ai.description': 'Intelligent suggestions and connections between your memories powered by advanced machine learning.',
        'features.sync.title': 'Seamless Sync',
        'features.sync.description': 'Your memories sync instantly across all your Apple devices with end-to-end encryption.',
        'features.immersive.title': 'Immersive Environments',
        'features.immersive.description': 'Create and customize virtual environments that enhance your focus and creativity.',
        'features.collaborative.title': 'Collaborative Spaces',
        'features.collaborative.description': 'Share and collaborate on memory spaces with friends and family in real-time.',
        'features.media.title': 'Rich Media Support',
        'features.media.description': 'Support for photos, videos, 3D models, and spatial audio in your memory collections.',
        
        // Demo Section
        'demo.title': 'See MemoSpace in Action',
        'demo.description': 'Experience the future of memory organization with our interactive demo',
        
        // About Page
        'about.title': 'About',
        'about.subtitle': 'We\'re a team of passionate innovators dedicated to revolutionizing how humans interact with their memories and ideas in spatial computing environments.',
        'about.mission.title': 'Our Mission',
        'about.team.title': 'Meet Our Team',
        'about.team.subtitle': 'The visionaries and builders behind MemoSpace',
        'about.values.title': 'Our Values',
        'about.values.subtitle': 'The principles that guide everything we do',
        
        // Contact Page
        'contact.title': 'Get in Touch',
        'contact.subtitle': 'Have a question about MemoSpace? Want to join our beta program? We\'d love to hear from you.',
        'contact.form.title': 'Send us a message',
        'contact.form.firstName': 'First Name',
        'contact.form.lastName': 'Last Name',
        'contact.form.email': 'Email Address',
        'contact.form.company': 'Company (Optional)',
        'contact.form.subject': 'Subject',
        'contact.form.message': 'Message',
        'contact.form.submit': 'Send Message',
        
        // Footer
        'footer.tagline': 'Reimagining spatial computing',
        'footer.copyright': '© 2025 MemoSpace. All rights reserved.',
        
        // Placeholder texts
        'placeholder.demo.video': 'Demo Video Placeholder<br><small>Add your demo video: assets/demo-video.mp4</small>',
        'placeholder.footer.product': 'Product',
        'placeholder.footer.company': 'Company', 
        'placeholder.footer.support': 'Support',
        'placeholder.footer.features': 'Features',
        'placeholder.footer.download': 'Download',
        'placeholder.footer.requirements': 'System Requirements',
        'placeholder.footer.aboutus': 'About Us',
        'placeholder.footer.careers': 'Careers',
        'placeholder.footer.helpCenter': 'Help Center',
        'placeholder.footer.privacy': 'Privacy Policy',
        'placeholder.footer.terms': 'Terms of Service',
        
        // Language Switcher
        'lang.english': 'English',
        'lang.traditional-chinese': '繁體中文',
        'lang.simplified-chinese': '简体中文'
    },
    'zh-TW': {
        // Navigation
        'nav.home': '首頁',
        'nav.features': '功能特色',
        'nav.about': '關於我們',
        'nav.contact': '聯絡我們',
        
        // Hero Section
        'hero.title': 'MemoSpace',
        'hero.subtitle': '為 Vision OS 重新設計',
        'hero.description': '體驗前所未有的空間運算。在適應您思維的三維工作空間中整理您的記憶、想法和創意。',
        'hero.cta.primary': '體驗產品',
        'hero.cta.secondary': '觀看示範',
        
        // Features Section
        'features.title': '革命性功能',
        'features.subtitle': '為空間運算的未來而設計',
        'features.spatial.title': '空間組織',
        'features.spatial.description': '透過直覺的手勢和眼動追蹤，在三維空間中整理您的記憶。',
        'features.ai.title': 'AI 智慧洞察',
        'features.ai.description': '由先進機器學習驅動的智慧建議和記憶之間的連結。',
        'features.sync.title': '無縫同步',
        'features.sync.description': '您的記憶透過端到端加密在所有 Apple 裝置間即時同步。',
        'features.immersive.title': '沉浸式環境',
        'features.immersive.description': '創建和自訂虛擬環境，增強您的專注力和創造力。',
        'features.collaborative.title': '協作空間',
        'features.collaborative.description': '與朋友和家人即時分享並協作記憶空間。',
        'features.media.title': '豐富媒體支援',
        'features.media.description': '在您的記憶收藏中支援照片、影片、3D 模型和空間音訊。',
        
        // Demo Section
        'demo.title': '見證 MemoSpace 的實際運作',
        'demo.description': '透過我們的互動示範體驗記憶組織的未來',
        
        // About Page
        'about.title': '關於我們',
        'about.subtitle': '我們是一群充滿熱忱的創新者，致力於革新人類在空間運算環境中與記憶和想法互動的方式。',
        'about.mission.title': '我們的使命',
        'about.team.title': '認識我們的團隊',
        'about.team.subtitle': 'MemoSpace 背後的願景家和建造者',
        'about.values.title': '我們的價值觀',
        'about.values.subtitle': '指導我們所有行動的原則',
        
        // Contact Page
        'contact.title': '聯絡我們',
        'contact.subtitle': '對 MemoSpace 有疑問？想加入我們的測試計畫？我們很樂意聽取您的意見。',
        'contact.form.title': '發送訊息給我們',
        'contact.form.firstName': '名字',
        'contact.form.lastName': '姓氏',
        'contact.form.email': '電子郵件地址',
        'contact.form.company': '公司（選填）',
        'contact.form.subject': '主旨',
        'contact.form.message': '訊息',
        'contact.form.submit': '發送訊息',
        
        // Footer
        'footer.tagline': '重新想像空間運算',
        'footer.copyright': '© 2025 MemoSpace. 版權所有。',
        
        // Placeholder texts
        'placeholder.demo.video': '示範影片預留位置<br><small>新增您的示範影片：assets/demo-video.mp4</small>',
        'placeholder.footer.product': '產品',
        'placeholder.footer.company': '公司',
        'placeholder.footer.support': '支援',
        'placeholder.footer.features': '功能特色',
        'placeholder.footer.download': '下載',
        'placeholder.footer.requirements': '系統需求',
        'placeholder.footer.aboutus': '關於我們',
        'placeholder.footer.careers': '職涯機會',
        'placeholder.footer.helpCenter': '幫助中心',
        'placeholder.footer.privacy': '隱私政策',
        'placeholder.footer.terms': '服務條款',
        
        // Language Switcher
        'lang.english': 'English',
        'lang.traditional-chinese': '繁體中文',
        'lang.simplified-chinese': '简体中文'
    },
    'zh-CN': {
        // Navigation
        'nav.home': '首页',
        'nav.features': '功能特色',
        'nav.about': '关于我们',
        'nav.contact': '联系我们',
        
        // Hero Section
        'hero.title': 'MemoSpace',
        'hero.subtitle': '为 Vision OS 重新设计',
        'hero.description': '体验前所未有的空间计算。在适应您思维的三维工作空间中整理您的记忆、想法和创意。',
        'hero.cta.primary': '体验产品',
        'hero.cta.secondary': '观看演示',
        
        // Features Section
        'features.title': '革命性功能',
        'features.subtitle': '为空间计算的未来而设计',
        'features.spatial.title': '空间组织',
        'features.spatial.description': '通过直观的手势和眼动追踪，在三维空间中整理您的记忆。',
        'features.ai.title': 'AI 智能洞察',
        'features.ai.description': '由先进机器学习驱动的智能建议和记忆之间的连接。',
        'features.sync.title': '无缝同步',
        'features.sync.description': '您的记忆通过端到端加密在所有 Apple 设备间即时同步。',
        'features.immersive.title': '沉浸式环境',
        'features.immersive.description': '创建和自定义虚拟环境，增强您的专注力和创造力。',
        'features.collaborative.title': '协作空间',
        'features.collaborative.description': '与朋友和家人实时分享并协作记忆空间。',
        'features.media.title': '丰富媒体支持',
        'features.media.description': '在您的记忆收藏中支持照片、视频、3D 模型和空间音频。',
        
        // Demo Section
        'demo.title': '见证 MemoSpace 的实际运作',
        'demo.description': '通过我们的交互演示体验记忆组织的未来',
        
        // About Page
        'about.title': '关于我们',
        'about.subtitle': '我们是一群充满热情的创新者，致力于革新人类在空间计算环境中与记忆和想法互动的方式。',
        'about.mission.title': '我们的使命',
        'about.team.title': '认识我们的团队',
        'about.team.subtitle': 'MemoSpace 背后的愿景家和建造者',
        'about.values.title': '我们的价值观',
        'about.values.subtitle': '指导我们所有行动的原则',
        
        // Contact Page
        'contact.title': '联系我们',
        'contact.subtitle': '对 MemoSpace 有疑问？想加入我们的测试计划？我们很乐意听取您的意见。',
        'contact.form.title': '发送消息给我们',
        'contact.form.firstName': '名字',
        'contact.form.lastName': '姓氏',
        'contact.form.email': '电子邮件地址',
        'contact.form.company': '公司（选填）',
        'contact.form.subject': '主题',
        'contact.form.message': '消息',
        'contact.form.submit': '发送消息',
        
        // Footer
        'footer.tagline': '重新想象空间计算',
        'footer.copyright': '© 2025 MemoSpace. 版权所有。',
        
        // Placeholder texts
        'placeholder.demo.video': '演示视频占位符<br><small>添加您的演示视频：assets/demo-video.mp4</small>',
        'placeholder.footer.product': '产品',
        'placeholder.footer.company': '公司',
        'placeholder.footer.support': '支持',
        'placeholder.footer.features': '功能特色',
        'placeholder.footer.download': '下载',
        'placeholder.footer.requirements': '系统要求',
        'placeholder.footer.aboutus': '关于我们',
        'placeholder.footer.careers': '职业机会',
        'placeholder.footer.helpCenter': '帮助中心',
        'placeholder.footer.privacy': '隐私政策',
        'placeholder.footer.terms': '服务条款',
        
        // Language Switcher
        'lang.english': 'English',
        'lang.traditional-chinese': '繁體中文',
        'lang.simplified-chinese': '简体中文'
    }
};

class I18n {
    constructor() {
        this.currentLanguage = this.detectLanguage();
        this.translations = translations;
    }

    detectLanguage() {
        // Check URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const langParam = urlParams.get('lang');
        if (langParam && this.translations[langParam]) {
            return langParam;
        }

        // Check localStorage
        const savedLang = localStorage.getItem('memoSpace_language');
        if (savedLang && this.translations[savedLang]) {
            return savedLang;
        }

        // Check browser language
        const browserLang = navigator.language || navigator.userLanguage;
        if (browserLang.startsWith('zh')) {
            if (browserLang.includes('TW') || browserLang.includes('HK') || browserLang.includes('MO')) {
                return 'zh-TW';
            } else {
                return 'zh-CN';
            }
        }

        return 'en'; // default to English
    }

    setLanguage(lang) {
        if (!this.translations[lang]) {
            console.warn(`Language ${lang} not supported`);
            return;
        }

        this.currentLanguage = lang;
        localStorage.setItem('memoSpace_language', lang);
        
        // Update URL without reload
        const url = new URL(window.location);
        url.searchParams.set('lang', lang);
        window.history.pushState({}, '', url);

        this.updateContent();
        this.updateLanguageSwitcher();
        this.updateDocumentLanguage();
    }

    translate(key) {
        const keys = key.split('.');
        let value = this.translations[this.currentLanguage];
        
        for (const k of keys) {
            if (value && typeof value === 'object') {
                value = value[k];
            } else {
                break;
            }
        }

        return value || this.translations['en'][key] || key;
    }

    updateContent() {
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.translate(key);
            
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });

        // Update meta description
        const metaDesc = document.querySelector('meta[name="description"]');
        if (metaDesc) {
            const descKey = metaDesc.getAttribute('data-i18n');
            if (descKey) {
                metaDesc.content = this.translate(descKey);
            }
        }

        // Update page title
        const titleElement = document.querySelector('title');
        if (titleElement) {
            const titleKey = titleElement.getAttribute('data-i18n');
            if (titleKey) {
                titleElement.textContent = this.translate(titleKey);
            }
        }
    }

    updateLanguageSwitcher() {
        const currentLangBtn = document.querySelector('.language-btn .lang-text');
        const langOptions = document.querySelectorAll('.language-option');

        if (currentLangBtn) {
            currentLangBtn.textContent = this.translate(`lang.${this.getLanguageName(this.currentLanguage)}`);
        }

        langOptions.forEach(option => {
            const lang = option.getAttribute('data-lang');
            option.classList.toggle('active', lang === this.currentLanguage);
        });
    }

    updateDocumentLanguage() {
        document.documentElement.lang = this.currentLanguage;
    }

    getLanguageName(lang) {
        const names = {
            'en': 'english',
            'zh-TW': 'traditional-chinese',
            'zh-CN': 'simplified-chinese'
        };
        return names[lang] || 'english';
    }

    init() {
        this.updateContent();
        this.updateLanguageSwitcher();
        this.updateDocumentLanguage();
        this.setupEventListeners();
    }

    setupEventListeners() {
        // Language switcher click events
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('language-option')) {
                e.preventDefault();
                const lang = e.target.getAttribute('data-lang');
                this.setLanguage(lang);
            }
        });

        // Handle browser back/forward
        window.addEventListener('popstate', () => {
            const newLang = this.detectLanguage();
            if (newLang !== this.currentLanguage) {
                this.currentLanguage = newLang;
                this.updateContent();
                this.updateLanguageSwitcher();
                this.updateDocumentLanguage();
            }
        });
    }
}

// Initialize i18n when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    window.i18n = new I18n();
    window.i18n.init();
});

// Export for use in other scripts
if (typeof module !== 'undefined' && module.exports) {
    module.exports = I18n;
}
